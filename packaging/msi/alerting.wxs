<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">
  <Package
      Name="Alerting"
      Manufacturer="Alerting"
      Version="1.0.0"
      Language="1033"
      UpgradeCode="{6D4F9B52-1AA1-4F9C-8AA2-B23D1562A21E}"
      InstallerVersion="500"
      Compressed="yes"
      Scope="perUser">

    <MajorUpgrade DowngradeErrorMessage="A newer version of Alerting is already installed." />

    <Media Id="1" Cabinet="product.cab" EmbedCab="yes" />

    <StandardDirectory Id="LocalAppDataFolder">
      <Directory Id="INSTALLFOLDER" Name="Alerting">
        <Component Id="cmpAlertingExe" Guid="{8A9531A4-6D82-4F13-861D-0F8DC8D302FD}" Directory="INSTALLFOLDER">
          <File Id="AlertingExe" Source="$(var.AlertingExecutable)" KeyPath="yes" />
        </Component>

        <Component Id="cmpLauncherExe" Guid="{A7B9E534-5F16-4F2A-9841-570F7C3B6F32}" Directory="INSTALLFOLDER">
          <File Id="AlertingLauncherExe" Source="$(var.AlertingLauncherExecutable)" KeyPath="yes">
            <!-- Pas d'attribut Target ici : le Shortcut est automatiquement liÃ© au File parent -->
            <Shortcut
              Id="AlertingShortcut"
              Name="Alerting"
              Directory="ShortcutDir"
              WorkingDirectory="INSTALLFOLDER" />
          </File>
        </Component>
      </Directory>
    </StandardDirectory>

    <StandardDirectory Id="ProgramMenuFolder">
      <Directory Id="ShortcutDir" Name="Alerting" />
    </StandardDirectory>

    <Component Id="cmpInstallerReg" Guid="{D9B6A2E1-1234-4F88-9B1A-ABCDEF123456}" Directory="INSTALLFOLDER">
      <RegistryValue
          Root="HKCU"
          Key="Software\\Alerting"
          Name="Installer"
          Type="integer"
          Value="1"
          KeyPath="yes" />
    </Component>

    <ComponentGroup Id="ProductComponents">
      <ComponentRef Id="cmpAlertingExe" />
      <ComponentRef Id="cmpLauncherExe" />
      <ComponentRef Id="cmpInstallerReg" />
    </ComponentGroup>

    <Feature Id="MainFeature" Title="Alerting" Level="1">
      <ComponentGroupRef Id="ProductComponents" />
    </Feature>
  </Package>
</Wix>
